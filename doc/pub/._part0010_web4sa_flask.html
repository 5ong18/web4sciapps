<html>
<head>
<!--
This style is adopted from the (now old) vagrant 1.0 web
pages. The style builds on the Twitter Bootstrap style.
Modifications by Hans Petter Langtangen, hpl@simula.no.

This style file should be copied and the following
elements edited:

Logo heading:

 LogoWord
 withSubWord

Navigation links at the top:

 GO TO 1
 GO TO 2

Footer at the end:

 Here goes a footer, if desired, maybe with a Copyright &copy;

-->

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Doconce: http://code.google.com/p/doconce/" />

<link rel="stylesheet" href="html_templates/css/twitter_bootstrap.css">
<link rel="stylesheet" href="html_templates/css/vagrant.css">
<!-- Define color of headings here (last definition counts) -->
<style type="text/css">
h1, h2, h3, h4, h5, h6 {
  color: #000;     /* black */
  color: #999;     /* gray */
  color: #005580;  /* dark blue */
  color: #08c;     /* characteristic blue */
</style>
</head>
<body>

<title> Exercise 3: Auto-generate code from function signature </title>

<!-- ------------------- main content ------------------------>

<div class="container">
 <div class="row Header with-border">
  <div class="span3 Module logo">
   <h1><a href="/">Flask<span class="subtitle">4scientists</span></a></h1>
  </div>
  <div class="span9">
   <div class="Module navigation">
   <!-- Navigation at the top of the page -->
    <ul>
     <li> <a href="http://flask.pocoo.org/">Flask</a></li>
    </ul>
   </div>
  </div>
 </div>
</div>


<!-- Here goes the table of contents in the sidebar
     <li class="active"> means dark blue background for current section
-->
<div class="row">
 <div class="span3 Module sidebar">
  <div class="well" style="padding: 8px 0px;">
   <ul class="nav nav-list">
     <!-- Syntax:
     <li> <a href="...">Section 1</a></li>
     <li> <a href="...">Section 2</a></li>
     <li> &nbsp;&nbsp;&nbsp; <a href="...">Section 2a</a></li>
     <li> &nbsp;&nbsp;&nbsp; <a href="...">Section 2b</a></li>
     -->
     <!-- Doconce automatically fills in the table of contents -->
          <!-- vagrant nav toc: " Web frameworks " --> <li>  <a href="._part0000_web4sa_flask.html#___sec0"> Web frameworks </a>
     <!-- vagrant nav toc: " The MVC pattern " --> <li> &nbsp;  <a href="._part0001_web4sa_flask.html#___sec1"> The MVC pattern </a>
     <!-- vagrant nav toc: " A very simple application " --> <li> &nbsp;  <a href="._part0002_web4sa_flask.html#___sec2"> A very simple application </a>
     <!-- vagrant nav toc: " Application of the MVC pattern " --> <li> &nbsp;  <a href="._part0003_web4sa_flask.html#wf:hw:mvc"> Application of the MVC pattern </a>
     <!-- vagrant nav toc: " Making a Flask application " --> <li>  <a href="._part0003_web4sa_flask.html#___sec4"> Making a Flask application </a>
     <!-- vagrant nav toc: " Programming the Flask application " --> <li> &nbsp;  <a href="._part0003_web4sa_flask.html#___sec5"> Programming the Flask application </a>
     <!-- vagrant nav toc: " Equipping the input page with output results " --> <li> &nbsp;  <a href="._part0004_web4sa_flask.html#___sec6"> Equipping the input page with output results </a>
     <!-- vagrant nav toc: " Splitting the app into model, view, and controller files " --> <li> &nbsp;  <a href="._part0005_web4sa_flask.html#wf:hw3:flask"> Splitting the app into model, view, and controller files </a>
     <!-- vagrant nav toc: " Troubleshooting " --> <li> &nbsp;  <a href="._part0005_web4sa_flask.html#___sec8"> Troubleshooting </a>
     <!-- vagrant nav toc: " Handling multiple input variables in Flask " --> <li>  <a href="._part0005_web4sa_flask.html#wf:vib:flask"> Handling multiple input variables in Flask </a>
     <!-- vagrant nav toc: " Programming the Flask application " --> <li> &nbsp;  <a href="._part0006_web4sa_flask.html#___sec10"> Programming the Flask application </a>
     <!-- vagrant nav toc: " Implementing error checking in the template " --> <li> &nbsp;  <a href="._part0007_web4sa_flask.html#___sec11"> Implementing error checking in the template </a>
     <!-- vagrant nav toc: " Using style sheets " --> <li> &nbsp;  <a href="._part0008_web4sa_flask.html#___sec12"> Using style sheets </a>
     <!-- vagrant nav toc: " Using LaTeX mathematics " --> <li> &nbsp;  <a href="._part0009_web4sa_flask.html#___sec13"> Using LaTeX mathematics </a>
     <!-- vagrant nav toc: " User-provided validation " --> <li class="active"> &nbsp;  <a href="._part0010_web4sa_flask.html#___sec14"> User-provided validation </a>
     <!-- vagrant nav toc: " Exercise 1: Add two numbers in a Flask app " --> <li> &nbsp;  <a href="._part0010_web4sa_flask.html#wf:exer:flask:add2"> Exercise 1: Add two numbers in a Flask app </a>
     <!-- vagrant nav toc: " Exercise 2: Add two numbers in a Django app " --> <li> &nbsp;  <a href="._part0010_web4sa_flask.html#wf:exer:django:add2"> Exercise 2: Add two numbers in a Django app </a>
     <!-- vagrant nav toc: " Exercise 3: Auto-generate code from function signature " --> <li> &nbsp;  <a href="._part0010_web4sa_flask.html#___sec17"> Exercise 3: Auto-generate code from function signature </a>

    </ul>
   </div>
  </div>

  <div class="span9">


<!-- tocinfo
{'highest level': 1,
 'sections': [(' Web frameworks ', 1, None, '___sec0'),
              (' The MVC pattern ', 2, None, '___sec1'),
              (' A very simple application ', 2, None, '___sec2'),
              (' Application of the MVC pattern ',
               2,
               'wf:hw:mvc',
               'wf:hw:mvc'),
              (' Making a Flask application ', 1, None, '___sec4'),
              (' Programming the Flask application ', 2, None, '___sec5'),
              (' Equipping the input page with output results ',
               2,
               None,
               '___sec6'),
              (' Splitting the app into model, view, and controller files ',
               2,
               'wf:hw3:flask',
               'wf:hw3:flask'),
              (' Troubleshooting ', 2, None, '___sec8'),
              (' Handling multiple input variables in Flask ',
               1,
               'wf:vib:flask',
               'wf:vib:flask'),
              (' Programming the Flask application ', 2, None, '___sec10'),
              (' Implementing error checking in the template ',
               2,
               None,
               '___sec11'),
              (' Using style sheets ', 2, None, '___sec12'),
              (' Using LaTeX mathematics ', 2, None, '___sec13'),
              (' User-provided validation ', 2, None, '___sec14'),
              (' Exercise 1: Add two numbers in a Flask app ',
               2,
               'wf:exer:flask:add2',
               'wf:exer:flask:add2'),
              (' Exercise 2: Add two numbers in a Django app ',
               2,
               'wf:exer:django:add2',
               'wf:exer:django:add2'),
              (' Exercise 3: Auto-generate code from function signature ',
               2,
               None,
               '___sec17')]}
end of tocinfo -->





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js"]
  }
});
</script>
<script type="text/javascript"
 src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- Fix slow MathJax rendering in IE8 -->
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7">




<a name="part0010"></a>
<!-- !split -->

<h3>User-provided validation  <a name="___sec14"></a></h3>

<p>


The <code>FloatField</code> objects can check that the input is compatible with
a number, but what if we want to control that \( A>0 \), \( b>0 \), and
\( T \) is not greater than 30 periods (otherwise the plot gets cluttered)?
We can write functions for checking appropriate conditions and
supply the function to the list of validator functions in the call to
the <code>FloatField</code> constructor or other field constructors. The extra
code is a part of the <code>model.py</code> and the presented extensions appear
in the directory <code>vib2_flask</code>.

<p>
The simplest approach to validation is to use existing functionality
in the web framework. Checking that \( A>0 \) can be done by
the <code>NumberRange</code> validator which checks that the value is inside
a prescribed interval:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">wtforms</span> <span style="color: #008000; font-weight: bold">import</span> Form, FloatField, validators

<span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">InputForm</span>(Form):
    A <span style="color: #666666">=</span> FloatField(
        label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;amplitude (m)&#39;</span>, default<span style="color: #666666">=1.0</span>,
        validators<span style="color: #666666">=</span>[validators<span style="color: #666666">.</span>NumberRange(<span style="color: #666666">0</span>, <span style="color: #666666">1E+20</span>)])
</pre></div>
<p>

We can also easily provide our own more tailored validators.
As an example, let us explain how we can check that \( T \) is less than 30 periods.
One period is \( 2\pi /w \) so we need to check if \( T> 30\cdot 2\pi/w \)
and raise an exception in that case.
A validation function takes two arguments: the whole <code>form</code> and the
specific <code>field</code> to test:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">check_T</span>(form, field):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;Form validation: failure if T &gt; 30 periods.&quot;&quot;&quot;</span>
    w <span style="color: #666666">=</span> form<span style="color: #666666">.</span>w<span style="color: #666666">.</span>data
    T <span style="color: #666666">=</span> field<span style="color: #666666">.</span>data
    period <span style="color: #666666">=</span> <span style="color: #666666">2*</span>pi<span style="color: #666666">/</span>w
    <span style="color: #008000; font-weight: bold">if</span> T <span style="color: #666666">&gt;</span> <span style="color: #666666">30*</span>period:
        num_periods <span style="color: #666666">=</span> <span style="color: #008000">int</span>(<span style="color: #008000">round</span>(T<span style="color: #666666">/</span>period))
        <span style="color: #008000; font-weight: bold">raise</span> validators<span style="color: #666666">.</span>ValidationError(
            <span style="color: #BA2121">&#39;Cannot plot as much as </span><span style="color: #BB6688; font-weight: bold">%d</span><span style="color: #BA2121"> periods! T&lt;</span><span style="color: #BB6688; font-weight: bold">%.2f</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span>
            (num_periods, <span style="color: #666666">30*</span>period))
</pre></div>
<p>
The appropriate exception is of type <code>validators.ValidationError</code>.
Observe that through <code>form</code> we have in fact access to all the input
data so we can easily use the value of \( w \) when checking the validity
of the value of \( T \). The <code>check_T</code> function is easy to
add to the list of validator functions in the call to the <code>FloatField</code>
constructor for <code>T</code>:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">InputForm</span>(Form):
    <span style="color: #666666">...</span>
    T <span style="color: #666666">=</span> FloatField(
        label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;time interval&#39;</span>, default<span style="color: #666666">=6*</span>pi,
        validators<span style="color: #666666">=</span>[validators<span style="color: #666666">.</span>InputRequired(), check_T])
</pre></div>
<p>
The validator
objects are tested one by one as the appear in the list, and if
one fails, the others are not invoked.
We therefore add <code>check_T</code> after the check of input such that we know we
have a value for all data when we run the computations and test
in <code>check_T</code>.

<p>
Although there is already a <code>NumberRange</code> validator for checking
whether a value is inside an interval, we can write our own
version with some improved functionality for open intervals where
the maximum or minimum value can be infinite.
The infinite value can on input be represented by <code>None</code>.
A general such function may take the form

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">check_interval</span>(form, field, min_value<span style="color: #666666">=</span><span style="color: #008000">None</span>, max_value<span style="color: #666666">=</span><span style="color: #008000">None</span>):
    <span style="color: #BA2121; font-style: italic">&quot;&quot;&quot;For validation: failure if value is outside an interval.&quot;&quot;&quot;</span>
    failure <span style="color: #666666">=</span> <span style="color: #008000">False</span>
    <span style="color: #008000; font-weight: bold">if</span> min_value <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> field<span style="color: #666666">.</span>data <span style="color: #666666">&lt;</span> min_value:
            failure <span style="color: #666666">=</span> <span style="color: #008000">True</span>
    <span style="color: #008000; font-weight: bold">if</span> max_value <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #008000">None</span>:
        <span style="color: #008000; font-weight: bold">if</span> field<span style="color: #666666">.</span>data <span style="color: #666666">&gt;</span> max_value:
            failure <span style="color: #666666">=</span> <span style="color: #008000">True</span>
    min_value <span style="color: #666666">=</span> <span style="color: #BA2121">&#39;-infty&#39;</span> <span style="color: #008000; font-weight: bold">if</span> min_value <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000">str</span>(min_value)
    max_value <span style="color: #666666">=</span>  <span style="color: #BA2121">&#39;infty&#39;</span> <span style="color: #008000; font-weight: bold">if</span> max_value <span style="color: #AA22FF; font-weight: bold">is</span> <span style="color: #008000">None</span> <span style="color: #008000; font-weight: bold">else</span> <span style="color: #008000">str</span>(max_value)
    <span style="color: #008000; font-weight: bold">if</span> failure:
        <span style="color: #008000; font-weight: bold">raise</span> validators<span style="color: #666666">.</span>ValidationError(
            <span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">=</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> not in [</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">, </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">]&#39;</span> <span style="color: #666666">%</span> (field<span style="color: #666666">.</span>name, field<span style="color: #666666">.</span>data,
                                       min_value, max_value))
</pre></div>
<p>

The problem is that <code>check_interval</code> takes four arguments, not only
the <code>form</code> and <code>field</code> arguments that a validator function can accept.
The way out of this difficulty is to use a Python tool <code>functools.partial</code>
which allows us to call a function with some of the arguments set.
Here, we want to create a new function that calls <code>check_interval</code>
with some prescribed values of <code>min_value</code> and <code>max_value</code>.
This function looks like it does not have these arguments, only
<code>form</code> and <code>field</code>. The following function produces this function:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">functools</span>

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">interval</span>(min_value<span style="color: #666666">=</span><span style="color: #008000">None</span>, max_value<span style="color: #666666">=</span><span style="color: #008000">None</span>):
    <span style="color: #008000; font-weight: bold">return</span> functools<span style="color: #666666">.</span>partial(
        check_interval, min_value<span style="color: #666666">=</span>min_value, max_value<span style="color: #666666">=</span>max_value)
</pre></div>
<p>
We can in any field constructor just add
<code>interval(a, b)</code> as a validator function checking if the field value is
in the interval between <code>a</code> and <code>b</code>:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">InputForm</span>(Form):
    <span style="color: #666666">...</span>
    b <span style="color: #666666">=</span> FloatField(
        label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;damping factor (kg/s)&#39;</span>, default<span style="color: #666666">=0</span>,
        validators<span style="color: #666666">=</span>[validators<span style="color: #666666">.</span>InputRequired(), interval(<span style="color: #666666">0</span>,<span style="color: #008000">None</span>)])
</pre></div>
<p>

Let us test our tailored error checking. Run <code>python controller.py</code>
in the <code>vib2_flask</code> directory and fill in \( -1.0 \) in the \( b \) field.
Pressing <em>Compute</em> invokes our <code>interval(0,None)</code> function, which
is nothing but a call <code>check_interval(field, form, 0, None)</code>,
and the test <code>if field.data < min_value</code> becomes true, <code>failure</code>
is set and the exception is raised. The message in the exception
is available in the <code>field.errors</code> attribute so our template
will write it out in red, see Figure <a href="#wf:vib2:flask:fig:error1">8</a>.
The template used in <code>vib_flask</code> is basically the same as <code>view3.html</code>
in <code>vib1_flask</code>, i.e., it feaures LaTeX mathematics and checking of
<code>field.errors</code>.

<p>

<center> <!-- figure -->
<hr class="figure">
<center><p class="caption">Figure 8:  Triggering of a user-defined error check. <a name="wf:vib2:flask:fig:error1"></a> </p></center>
<p><img src="fig-web4sa/vib2_flask_error1.png" align="bottom" width=500></p>
</center>

<p>

Finally, we mention a detail in the <code>view.py</code> file in the <code>vib2_flask</code>
app: instead of sending <code>form.var.data</code> to the <code>compute</code> function we
may automatically generate a set of local variables such that the
work with data from the web page looks nicer:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">index</span>():
    form <span style="color: #666666">=</span> InputForm(request<span style="color: #666666">.</span>form)
    <span style="color: #008000; font-weight: bold">if</span> request<span style="color: #666666">.</span>method <span style="color: #666666">==</span> <span style="color: #BA2121">&#39;POST&#39;</span> <span style="color: #AA22FF; font-weight: bold">and</span> form<span style="color: #666666">.</span>validate():
        <span style="color: #008000; font-weight: bold">for</span> field <span style="color: #AA22FF; font-weight: bold">in</span> form:
            <span style="color: #408080; font-style: italic"># Make local variable (name field.name)</span>
            <span style="color: #008000; font-weight: bold">exec</span>(<span style="color: #BA2121">&#39;</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121"> = </span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">&#39;</span> <span style="color: #666666">%</span> (field<span style="color: #666666">.</span>name, field<span style="color: #666666">.</span>data))
        result <span style="color: #666666">=</span> compute(A, b, w, T)
    <span style="color: #008000; font-weight: bold">else</span>:
        result <span style="color: #666666">=</span> <span style="color: #008000">None</span>

    <span style="color: #008000; font-weight: bold">return</span> render_template(<span style="color: #BA2121">&#39;view.html&#39;</span>, form<span style="color: #666666">=</span>form, result<span style="color: #666666">=</span>result)
</pre></div>
<p>
The idea is just to run <code>exec</code> on a declaration of a local variable
with name <code>field.name</code> for each field in the form. This trick is often
neat if data are buried in objects and you want variables in your
code to look like they do in mathematical writing.

<p>

<!-- --- begin exercise --- -->

<p>

<h3>Exercise 1: Add two numbers in a Flask app <a name="wf:exer:flask:add2"></a></h3>

<p>
Make a Flask application that reads two numbers from a web page,
adds the numbers, and prints the sum in a new web page.
Package the Flask application directory in a tar file for easy testing
by others.
Filename: <code>add2_flask.tar.gz</code>.

<p>
<!-- --- end exercise --- -->

<p>


<!-- --- begin exercise --- -->

<p>

<h3>Exercise 2: Add two numbers in a Django app <a name="wf:exer:django:add2"></a></h3>

<p>
Make a Django application that reads two numbers from a web page,
adds the numbers, and prints the sum in a new web page.

<p>
Package
the application and a corresponding project in a tar file such
that anyone with Django installed can easily test the project.
Filename: <code>add2_django.tar.gz</code>.

<p>
<!-- --- end exercise --- -->

<p>


<!-- --- begin exercise --- -->

<p>

<h3>Exercise 3: Auto-generate code from function signature  <a name="___sec17"></a></h3>

<p>
Given a <code>compute_function</code> with a set of positional and keyword
arguments, we want to <em>automatically</em> generate the necessary
Flask code to built a web-based interface to calling this function
and presenting its result. In general, only this is known about
the function:
<p>

<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">compute_function</span>(<span style="color: #666666">*</span>args, <span style="color: #666666">**</span>kwargs)
    <span style="color: #666666">...</span>
    <span style="color: #008000; font-weight: bold">return</span> result
</pre></div>
<p>
Fortunately, Python has a module <code>inspect</code> that allows us to extract
the name of all function arguments and the default values of the keyword
arguments:

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">inspect</span>
arg_names <span style="color: #666666">=</span> inspect<span style="color: #666666">.</span>getargspec(compute_function)<span style="color: #666666">.</span>args
defaults  <span style="color: #666666">=</span> inspect<span style="color: #666666">.</span>getargspec(compute_function)<span style="color: #666666">.</span>defaults
</pre></div>
<p>
Here, <code>arg_names</code> is a list with the names of all arguments in
<code>compute_function</code>, while <code>defaults</code> is a list of the
values of all the keyword arguments. For example,

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">mycompute</span>(A, m<span style="color: #666666">=0</span>, s<span style="color: #666666">=1</span>, w<span style="color: #666666">=1</span>, <span style="color: #008000">xrange</span><span style="color: #666666">=</span>[<span style="color: #666666">-3</span>,<span style="color: #666666">3</span>]):
</pre></div>
<p>
leads to

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">arg_names <span style="color: #666666">=</span> [<span style="color: #BA2121">&#39;A&#39;</span>, <span style="color: #BA2121">&#39;m&#39;</span>, <span style="color: #BA2121">&#39;s&#39;</span>, <span style="color: #BA2121">&#39;w&#39;</span>, <span style="color: #BA2121">&#39;xrange&#39;</span>]
defaults <span style="color: #666666">=</span> (<span style="color: #666666">0</span>, <span style="color: #666666">1</span>, <span style="color: #666666">1</span>, [<span style="color: #666666">-3</span>, <span style="color: #666666">3</span>])
</pre></div>
<p>
We can hence use <code>inspect</code> to generate a web page where the user
can fill out values for all the argument names. Default values
can be inserted wherever we have them. Moreover, we can check
the type of the default values and use a corresponding field type:
for <code>int</code> and <code>float</code> we apply the corresponding <code>IntegerField</code>
and <code>FloatField</code>, for <code>str</code> we apply a <code>TextField</code>, <code>bool</code>
is represented by a <code>BooleanField</code>, for <code>list</code>, <code>tuple</code>, and
<code>numpy.ndarray</code> we can apply a <code>TextField</code> and then run <code>eval</code>
on the result, and a list of strings can be represented by <code>RadioField</code>.

<p>
Extracting the form values and calling <code>compute_function</code> can
be done with code like

<p>


<!-- code typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%">form_values <span style="color: #666666">=</span> [<span style="color: #008000">getattr</span>(form, name)<span style="color: #666666">.</span>data <span style="color: #008000; font-weight: bold">for</span> name <span style="color: #AA22FF; font-weight: bold">in</span> arg_names
               <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">hasattr</span>(form, name)]
result <span style="color: #666666">=</span> compute_function(<span style="color: #666666">*</span>form_values)
</pre></div>
<p>
Making a template with a table for all the input fields is straightforward,
but HTML rendering of the result is not. One generic solution is to
combine the table of input forms with a user-given template for how
<code>result</code> is presented on the web page. The combination of the two
templates constitutes the template to be used by the view.

<p>
Use these ideas to automatically generate the necessary code
for making a web interface to an arbitrary <code>compute_function</code>.
Filename: <code>generate_flask.py</code>.

<p>
<!-- --- end exercise --- -->

<p>
<!-- ------------------- end of main content --------------- -->


<!--
Preliminary examples/discussion on vagrant style syntax

<div class='alert alert-block alert-notice'>
  <h3>What about PHP? Python? Java?</h3>
<p>
bla-bla.
</div>

<p>
While the <div class="deep-blue">rest of the</div> getting started
-->

<ul class="pager">
  <li class="previous">
    <a href="._part0009_web4sa_flask.html">&larr; Prev</a>
  </li>


</ul>

 </div>

<!-- ------------------- end of main content --------------- -->

 <div class="row Footer">
  <div class="span12">
  Copyright &copy 2013; Hans Petter Langtangen and Anders E. Johansen.
  Last update: .
  </div>
 </div>
</div>
</body>
</html>



